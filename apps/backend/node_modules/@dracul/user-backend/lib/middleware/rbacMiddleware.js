"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _default;

var _RbacService = require("../services/RbacService");

async function _default(req, res, next) {
  try {
    if (req && req.user) {
      req.rbac = await (0, _RbacService.UserRbacFactory)(req.user);
    }

    next();
  } catch (error) {
    console.error("Rbac Middleware error:", error);
    next(error);
  }
}